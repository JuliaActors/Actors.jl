<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Actor Behavior · Actors.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Actors.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">Actors.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorial/install/">Install and Use <code>Actors</code></a></li><li><a class="tocitem" href="../../tutorial/intro/">Getting Started with Actors</a></li><li><a class="tocitem" href="../../tutorial/tabletennis/">Simulate a Game</a></li><li><a class="tocitem" href="../../tutorial/stack/">Implement a Stack</a></li><li><a class="tocitem" href="../../tutorial/dictsrv/">Implement a thread-safe <code>Dict</code></a></li><li><a class="tocitem" href="../../tutorial/supervise/">Supervise Actors</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../howto/spawn/"><code>spawn</code> actors</a></li><li><a class="tocitem" href="../../howto/communicate/">communicate with actors</a></li><li><a class="tocitem" href="../../howto/information/">get information from actors</a></li><li><a class="tocitem" href="../../howto/share/">(not) share variables</a></li><li><a class="tocitem" href="../../howto/failure/">deal with failures</a></li><li><a class="tocitem" href="../../howto/register/"><code>register</code> actors</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">On Actors</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../basics/">Actor Model</a></li><li><a class="tocitem" href="../actors/">Actors and Julia</a></li><li class="is-active"><a class="tocitem" href>Actor Behavior</a><ul class="internal"><li><a class="tocitem" href="#Behavior-Representation-in-Julia"><span>Behavior Representation in Julia</span></a></li><li><a class="tocitem" href="#Actor-Operation"><span>Actor Operation</span></a></li><li><a class="tocitem" href="#Actors-Don&#39;t-Share-State"><span>Actors Don&#39;t Share State</span></a></li></ul></li><li><a class="tocitem" href="../protocol/">Messaging Protocol</a></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Error Handling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../errors/">Error Handling Overview</a></li><li><a class="tocitem" href="../connections/">Connections</a></li><li><a class="tocitem" href="../monitors/">Monitors</a></li><li><a class="tocitem" href="../supervisors/">Supervisors</a></li><li><a class="tocitem" href="../node_failures/">Node Failures</a></li><li><a class="tocitem" href="../checkpoints/">Checkpointing</a></li><li><a class="tocitem" href="../fault_tolerance/">Fault Tolerance</a></li></ul></li><li><a class="tocitem" href="../infrastructure/">More Useful Stuff</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/api/"><code>Actors</code> Module</a></li><li><a class="tocitem" href="../../api/types/">Basic Types</a></li><li><a class="tocitem" href="../../api/starting/">Starting Actors, creating links</a></li><li><a class="tocitem" href="../../api/primitives/">Actor Primitives</a></li><li><a class="tocitem" href="../../api/comm/">Communication primitives</a></li><li><a class="tocitem" href="../../api/user_api/">User API</a></li><li><a class="tocitem" href="../../api/registry/">Actor Registry</a></li><li><a class="tocitem" href="../../api/connect/">Connections</a></li><li><a class="tocitem" href="../../api/monitor/">Monitors</a></li><li><a class="tocitem" href="../../api/supervision/">Supervisors</a></li><li><a class="tocitem" href="../../api/checkpointing/">Checkpointing</a></li><li><a class="tocitem" href="../../api/utils/">Utilities</a></li><li><a class="tocitem" href="../../api/diagnosis/">Diagnosis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/dining_phil/">Dining Philosophers</a></li><li><a class="tocitem" href="../../examples/prod_cons/">Producer-Consumer Problem</a></li><li><a class="tocitem" href="../../examples/examples/">Further Examples</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Internals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/diag/">Diagnostics</a></li><li><a class="tocitem" href="../../reference/internals/">Internals</a></li><li><a class="tocitem" href="../../reference/messages/">Messages</a></li><li><a class="tocitem" href="../../reference/interface/">Interface</a></li></ul></li><li><a class="tocitem" href="../../reference/glossary/">A Glossary of Actor Terms</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">On Actors</a></li><li class="is-active"><a href>Actor Behavior</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Actor Behavior</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaActors/Actors.jl/blob/master/docs/src/manual/behaviors.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Actor-Behavior"><a class="docs-heading-anchor" href="#Actor-Behavior">Actor Behavior</a><a id="Actor-Behavior-1"></a><a class="docs-heading-anchor-permalink" href="#Actor-Behavior" title="Permalink"></a></h1><p>An actor embodies the three essential elements of computation: 1) processing, 2) storage and 3) communication<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>. Its behavior therefore can be described as <span>$f(a)[c]$</span>,  representing</p><ol><li><span>$f$</span>: a function, <em>processing</em>,</li><li><span>$a$</span>: acquaintances, <em>storage</em>, data that it has,</li><li><span>$c$</span>: <em>communication</em>, a message.</li></ol><p>It processes an incoming message <span>$c$</span> with its behavior function <span>$f$</span> based on its acquaintances <span>$a$</span>.</p><blockquote><p>When an Actor receives a message, it can concurrently:</p><ul><li>send messages to ... addresses of Actors that it has;</li><li>create new Actors;</li><li>designate how to handle the next message it receives. <sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></li></ul></blockquote><p>Gul Agha described the <em>behavior</em> as a ...</p><blockquote><p>... function of the incoming communication.</p><p>Two lists of identifiers are used in a behavior definition. Values for the first list of parameters must be specified when the actor is created. This list is called the <em>acquaintance list</em>. The second list of parameters, called the <em>communication list</em>, gets its bindings from an incoming communication. <sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup></p></blockquote><p>A behavior then maps the incoming communication to a three tuple of messages sent, new actors created and the replacement behavior:</p><p class="math-container">\[\begin{array}{lrl}
f_i(a_i)[c_i] &amp; \rightarrow &amp;\{\{\mu_u,\mu_v, ...\},\;\{\alpha_x,\alpha_y,...\},\;f_{i+1}(a_{i+1})\} \quad\\
\textrm{with} &amp; f: &amp; \textrm{behavior function} \\
 &amp; a: &amp; \textrm{acquaintances,} \\
 &amp; c: &amp; \textrm{communication,} \\
 &amp; \mu: &amp; \textrm{messages sent,} \\
 &amp; \alpha: &amp; \textrm{actors created.} \\
\end{array}\]</p><h2 id="Behavior-Representation-in-Julia"><a class="docs-heading-anchor" href="#Behavior-Representation-in-Julia">Behavior Representation in Julia</a><a id="Behavior-Representation-in-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Behavior-Representation-in-Julia" title="Permalink"></a></h2><p><code>Actors</code> expresses actor behavior in a functional style. Actors are basically <em>function servers</em>. Their behavior is a <a href="https://en.wikipedia.org/wiki/Partial_application">partial application</a> of a callable object <span>$f(a...,c...)$</span> to acquaintances <span>$a...$</span>, that is, a closure over <span>$f(a...)$</span>. If the actor receives a communication <span>$c...$</span>, the closure invokes <span>$f(a...,c...)$</span>. The <a href="https://docs.julialang.org/en/v1.6/manual/faq/#What-does-the-...-operator-do?"><code>...</code>-operator</a> allows us to use multiple acquaintance and communication arguments (i.e. lists).</p><pre><code class="language-julia-repl">julia&gt; f(a, c) = a + c         # define a function
f (generic function with 1 method)

julia&gt; partial(f, a...; kw...) = (c...) -&gt; f(a..., c...; kw...)
partial (generic function with 1 method)

julia&gt; bhv = partial(f, 1)     # partially apply f to 1, return a closure
#2 (generic function with 1 method)

julia&gt; bhv(2)                  # execute f(1,2)
3</code></pre><p>Similar to the <code>partial</code> above, <a href="../../api/types/#Actors.Bhv"><code>Bhv</code></a> is a convenience function to create a partial application <code>ϕ(a...; kw...)</code> with optional keyword arguments, which can be executed with communication arguments <code>c...</code>:</p><pre><code class="language-julia-repl">julia&gt; using Actors, .Threads

julia&gt; import Actors: spawn, newLink

julia&gt; f(s, t; w=1, x=1) = s + t + w + x   # a function
f (generic function with 1 method)

julia&gt; bhv = Bhv(f, 2, w=2, x=2);          # create a behavior of f and acquaintances

julia&gt; bhv(2)                              # execute it with a communication parameter
8</code></pre><h3 id="Object-oriented-Style"><a class="docs-heading-anchor" href="#Object-oriented-Style">Object-oriented Style</a><a id="Object-oriented-Style-1"></a><a class="docs-heading-anchor-permalink" href="#Object-oriented-Style" title="Permalink"></a></h3><p>Alternatively we define an object with some data (acquaintances) and make it <a href="https://en.wikipedia.org/wiki/Function_object">callable</a> with communication parameters:</p><pre><code class="language-julia-repl">julia&gt; struct A                            # define an object
           s; w; x                         # with acquaintances
       end

julia&gt; (a::A)(t) = a.s + a.w + a.x + t     # make it a functor, executable with a communication parameter t

julia&gt; bhv = A(2, 2, 2)                    # create an instance
Main.ex-bhv.A(2, 2, 2)

julia&gt; bhv(2)                              # execute it with a parameter
8</code></pre><h2 id="Actor-Operation"><a class="docs-heading-anchor" href="#Actor-Operation">Actor Operation</a><a id="Actor-Operation-1"></a><a class="docs-heading-anchor-permalink" href="#Actor-Operation" title="Permalink"></a></h2><p>When we create an actor with a behavior by using <a href="../../api/starting/#ActorInterfaces.Classic.spawn"><code>spawn</code></a>, it is ready to receive communication arguments and to process them:</p><ol><li>You can create an actor with anything callable as behavior regardless whether it contains acquaintances or not.</li><li>Over its <a href="../../api/types/#Actors.Link"><code>Link</code></a> you can <a href="../../api/primitives/#ActorInterfaces.Classic.send"><code>send</code></a> it communication arguments and cause the actor to execute its behavior with them. <code>Actors</code>&#39; <a href="../../api/user_api/">API</a> functions like <a href="../../api/user_api/#Actors.call"><code>call</code></a>, <a href="../../api/user_api/#Actors.exec"><code>exec</code></a> are just wrappers around <code>send</code> and <a href="../../api/comm/#Actors.receive"><code>receive</code></a> using a communication <a href="../protocol/">protocol</a>.</li><li>If an actor receives wrong/unspecified communication arguments, it will fail with a <code>MethodError</code>.</li><li>With <a href="../../api/primitives/#Actors.become!"><code>become!</code></a> and <a href="../../api/primitives/#ActorInterfaces.Classic.become"><code>become</code></a> we can change an actor&#39;s behavior.</li></ol><pre><code class="language-julia-repl">julia&gt; me = newLink()
Link{Channel{Any}}(Channel{Any}(32), 1, :local)

julia&gt; myactor = spawn(()-&gt;send(me, threadid()),thrd=2) # create an actor with a parameterless anonymous behavior function
Link{Channel{Any}}(Channel{Any}(32), 1, :default)

julia&gt; send(myactor)                                    # send it an empty tuple
()

julia&gt; receive(me)                                      # receive the result
2

julia&gt; become!(myactor, threadid)
Actors.Become(Base.Threads.threadid)

julia&gt; call(myactor)                                    # call it without arguments
2

julia&gt; become!(myactor, (lk, x, y) -&gt; send(lk, x^y))    # an anonymous function with communication arguments
Actors.Become(Main.ex-bhv.var&quot;#4#5&quot;())

julia&gt; send(myactor, me, 123, 456)                      # send it arguments
(Link{Channel{Any}}(Channel{Any}(32), 1, :local), 123, 456)

julia&gt; receive(me)                                      # receive the result
2409344748064316129</code></pre><p>In setting actor behavior you are free to mix the functional and object oriented approaches. For example you can give functors further acquaintance parameters (as for the players in the <a href="../../tutorial/tabletennis/#table-tennis">table-tennis example</a>). Of course you can give objects containing acquaintances as parameters to a function and create a partial application with <code>Bhv</code> on them and much more.</p><h2 id="Actors-Don&#39;t-Share-State"><a class="docs-heading-anchor" href="#Actors-Don&#39;t-Share-State">Actors Don&#39;t Share State</a><a id="Actors-Don&#39;t-Share-State-1"></a><a class="docs-heading-anchor-permalink" href="#Actors-Don&#39;t-Share-State" title="Permalink"></a></h2><p>Actors must not share state in order to avoid race conditions. Acquaintance and communication parameters are actor state. <code>Actors</code> does not disallow for an actor to access and to modify mutable variables. It is therefore left to the programmer to exclude race conditions by not sharing them with other actors or tasks and accessing them concurrently. In most cases you can control which variables get passed to an actor and avoid to share them.</p><p>Note that when working with distributed actors, variables get copied automatically when sent over a <code>Link</code> (a <code>RemoteChannel</code>).</p><h3 id="Share-Actors-Instead-Of-Memory"><a class="docs-heading-anchor" href="#Share-Actors-Instead-Of-Memory">Share Actors Instead Of Memory</a><a id="Share-Actors-Instead-Of-Memory-1"></a><a class="docs-heading-anchor-permalink" href="#Share-Actors-Instead-Of-Memory" title="Permalink"></a></h3><p>But in many cases you want actors or tasks to concurrently use the same variables. You can then thread-safely model those as actors and share their links between actors and tasks alike. Each call to a link is a communication to an actor (instead of a concurrent access to a variable). See <a href="../../howto/share/">How to (not) share variables</a> for a receipt.</p><p>In the Actors documentation there are many examples on how actors represent variables and get shared between actors and tasks:</p><ul><li>In the <a href="../../tutorial/tabletennis/#table-tennis">table-tennis</a> example player actors working on different threads share a print server actor controlling access to the <code>stdio</code> variable.</li><li>In the <a href="../../tutorial/dictsrv/#dict-server">Dict-server</a> example a <code>Dict</code> variable gets served by an actor to tasks on parallel threads or workers.</li><li>In the <a href="../../examples/dining_phil/">Dining Philosophers</a> problem the shared chopsticks are expressed as actors. This avoids races and starvation between the philosopher actors.</li><li>In the <a href="../../examples/prod_cons/">Producer-Consumer</a> problem producers and consumers share a buffer modeled as an actor.</li><li>You can wrap mutable variables into a <a href="https://github.com/JuliaActors/Guards.jl"><code>:guard</code></a> actor, which will manage access to them.</li><li>In more complicated cases of resource sharing you can use a <a href="https://github.com/JuliaActors/GenServers.jl"><code>:genserver</code></a> actor.</li></ul><p>To model concurrently shared objects or data as actors is a common and successful pattern in actor programming. It makes it easier to write clear, correct concurrent programs. Unlike common tasks or also shared variables, actors are particularly suitable for this modeling because</p><ol><li>they are persistent objects like the variables or objects they represent and</li><li>they can express a behavior of those objects.</li></ol><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="http://channel9.msdn.com/Shows/Going+Deep/Hewitt-Meijer-and-Szyperski-The-Actor-Model-everything-you-wanted-to-know-but-were-afraid-to-ask">Hewitt, Meijer and Szyperski: The Actor Model (everything you wanted to know, but were afraid to ask)</a>, Microsoft Channel 9. April 9, 2012.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Carl Hewitt. Actor Model of Computation: Scalable Robust Information Systems.- <a href="https://arxiv.org/abs/1008.1459">arXiv:1008.1459</a>.</li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>Gul Agha 1986. <em>Actors. a model of concurrent computation in distributed systems</em>, MIT.- p. 30</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../actors/">« Actors and Julia</a><a class="docs-footer-nextpage" href="../protocol/">Messaging Protocol »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 21 April 2021 19:36">Wednesday 21 April 2021</span>. Using Julia version 1.6.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
