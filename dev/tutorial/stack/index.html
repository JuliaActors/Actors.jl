<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Implement a Stack · Actors.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Actors.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Actors.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../install/">Install and Use <code>Actors</code></a></li><li><a class="tocitem" href="../intro/">Getting Started with Actors</a></li><li><a class="tocitem" href="../tabletennis/">Simulate a Game</a></li><li class="is-active"><a class="tocitem" href>Implement a Stack</a></li><li><a class="tocitem" href="../dictsrv/">Implement a thread-safe <code>Dict</code></a></li><li><a class="tocitem" href="../supervise/">Supervise Actors</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../howto/spawn/"><code>spawn</code> actors</a></li><li><a class="tocitem" href="../../howto/communicate/">communicate with actors</a></li><li><a class="tocitem" href="../../howto/information/">get information from actors</a></li><li><a class="tocitem" href="../../howto/share/">(not) share variables</a></li><li><a class="tocitem" href="../../howto/failure/">deal with failures</a></li><li><a class="tocitem" href="../../howto/register/"><code>register</code> actors</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">On Actors</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../manual/basics/">Actor Model</a></li><li><a class="tocitem" href="../../manual/actors/">Actors and Julia</a></li><li><a class="tocitem" href="../../manual/behaviors/">Actor Behavior</a></li><li><a class="tocitem" href="../../manual/protocol/">Messaging Protocol</a></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Error Handling</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../manual/errors/">Error Handling Overview</a></li><li><a class="tocitem" href="../../manual/connections/">Connections</a></li><li><a class="tocitem" href="../../manual/monitors/">Monitors</a></li><li><a class="tocitem" href="../../manual/supervisors/">Supervisors</a></li><li><a class="tocitem" href="../../manual/node_failures/">Node Failures</a></li><li><a class="tocitem" href="../../manual/checkpoints/">Checkpointing</a></li><li><a class="tocitem" href="../../manual/fault_tolerance/">Fault Tolerance</a></li></ul></li><li><a class="tocitem" href="../../manual/infrastructure/">More Useful Stuff</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/api/"><code>Actors</code> Module</a></li><li><a class="tocitem" href="../../api/types/">Basic Types</a></li><li><a class="tocitem" href="../../api/starting/">Starting Actors, creating links</a></li><li><a class="tocitem" href="../../api/primitives/">Actor Primitives</a></li><li><a class="tocitem" href="../../api/comm/">Communication</a></li><li><a class="tocitem" href="../../api/user_api/">User API</a></li><li><a class="tocitem" href="../../api/registry/">Actor Registry</a></li><li><a class="tocitem" href="../../api/connect/">Connections</a></li><li><a class="tocitem" href="../../api/monitor/">Monitors</a></li><li><a class="tocitem" href="../../api/supervision/">Supervisors</a></li><li><a class="tocitem" href="../../api/checkpointing/">Checkpointing</a></li><li><a class="tocitem" href="../../api/utils/">Utilities</a></li><li><a class="tocitem" href="../../api/diagnosis/">Diagnosis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/dining_phil/">Dining Philosophers</a></li><li><a class="tocitem" href="../../examples/prod_cons/">Producer-Consumer Problem</a></li><li><a class="tocitem" href="../../examples/examples/">Further Examples</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Internals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/diag/">Diagnostics</a></li><li><a class="tocitem" href="../../reference/internals/">Internals</a></li><li><a class="tocitem" href="../../reference/messages/">Messages</a></li><li><a class="tocitem" href="../../reference/interface/">Interface</a></li></ul></li><li><a class="tocitem" href="../../reference/glossary/">A Glossary of Actor Terms</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Implement a Stack</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Implement a Stack</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaActors/Actors.jl/blob/master/docs/src/tutorial/stack.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="stack"><a class="docs-heading-anchor" href="#stack">Implement a Stack</a><a id="stack-1"></a><a class="docs-heading-anchor-permalink" href="#stack" title="Permalink"></a></h1><p>As an illustration of actor behavior we reproduce Gul Agha&#39;s example 3.2.1:</p><blockquote><p>We implement a stack as a collection of actors with uniform behavior. ... [A] linked list consists of a collection of nodes each of which stores a value and knows the mail address of the &quot;next&quot; actor in the chain. ... Two kinds of operations may be requested of a <em>stack-node</em>: a <em>push</em> or a <em>pop</em>. In the first case, the new content to be pushed must be given, and in the second, the customer to which the value stored in the <em>stack-node</em> can be sent. <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></p></blockquote><p>Let&#39;s first define some types:</p><pre><code class="language-julia hljs">mutable struct StackNode{T,L}  # a stack node object
    content::T
    link::L
end

struct Pop{L}                  # a pop message
    customer::L
end

struct Push{T}                 # a push message
    content::T
end</code></pre><blockquote><p>The top of the stack is the only receptionist in the stack system and was the only actor of the stack system created externally. It is created with a NIL content which is assumed to be the bottom of the stack marker. Notice that no mail address of a stack node is ever communicated by any node to an external actor. Therefore no actor outside the configuration defined above can effect any of the actors inside the stack except by sending the receptionist a communication. When a <em>pop</em> operation is done, the actor on top of the stack simply becomes a <em>forwarder</em> to the next actor in the link. This means that all communications received by the top of the stack are now forwarded to the next element. <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></p></blockquote><p>To implement the stack we use both the functional and the object oriented style for <a href="../../manual/behaviors/">actor behaviors</a>:</p><ul><li><code>forwarder</code> is just an alias for <code>send</code> which we put together with <code>sn.link</code> into a behavior. After <code>become(forwarder, sn.link)</code> the actor will forward any received message to <code>sn.link</code>.</li><li><code>StackNode</code> is a function object with two methods for <code>Pop</code> and <code>Push</code> messages.</li></ul><pre><code class="language-julia hljs">const forwarder = send
function (sn::StackNode)(msg::Pop)
    isnothing(sn.content) || become(forwarder, sn.link)
    send(msg.customer, sn.content)
end
(sn::StackNode)(msg::Push) = become(StackNode(msg.content, spawn(sn)))</code></pre><p>Now we can operate the stack:</p><pre><code class="language-julia hljs">julia&gt; mystack = spawn(StackNode(nothing, newLink())) # create the top of the stack
Link{Channel{Any}}(Channel{Any}(sz_max:32,sz_curr:0), 1, :default)

julia&gt; response = newLink()                           # create a response link
Link{Channel{Any}}(Channel{Any}(sz_max:32,sz_curr:0), 1, :local)

julia&gt; for i ∈ 1:5
           send(mystack, Push(i))
       end

julia&gt; for i ∈ 1:5
           send(mystack, Pop(response))
           println(receive(response))
       end
5
4
3
2
1</code></pre><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Gul Agha 1986. <em>Actors. a model of concurrent computation in distributed systems</em>, MIT.- p. 34f</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tabletennis/">« Simulate a Game</a><a class="docs-footer-nextpage" href="../dictsrv/">Implement a thread-safe <code>Dict</code> »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Friday 30 July 2021 09:44">Friday 30 July 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
