<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting started · Actors.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Actors.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">Actors.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Actors Documentation</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Getting started</a><ul class="internal"><li><a class="tocitem" href="#spawn"><span><code>spawn</code></span></a></li><li><a class="tocitem" href="#become"><span><code>become</code></span></a></li><li><a class="tocitem" href="#send-and-receive"><span><code>send</code> and <code>receive</code></span></a></li><li><a class="tocitem" href="#request"><span><code>request</code></span></a></li><li><a class="tocitem" href="#call,-cast,-query,-update!-..."><span><code>call</code>, <code>cast</code>, <code>query</code>, <code>update!</code> ...</span></a></li></ul></li><li><a class="tocitem" href="../basics/">Basics</a></li><li><a class="tocitem" href="../actors/">Actors</a></li><li><a class="tocitem" href="../behaviors/">Behaviors</a></li><li><a class="tocitem" href="../protocol/">Protocol</a></li><li><a class="tocitem" href="../infrastructure/">Infrastructure</a></li><li><a class="tocitem" href="../glossary/">Glossary</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Internals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../messages/">Messages</a></li><li><a class="tocitem" href="../interface/">Interface</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Getting started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting started</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaActors/Actors.jl/blob/master/docs/src/intro.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Getting-Started-with-Actors"><a class="docs-heading-anchor" href="#Getting-Started-with-Actors">Getting Started with Actors</a><a id="Getting-Started-with-Actors-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started-with-Actors" title="Permalink"></a></h1><p>You may have heard about the Actor Model, but here we present actors as a very practical thing, which you can <code>spawn</code>, <code>send</code> messages to, <code>receive</code> or <code>request</code> messages from, <code>call</code> them, <code>cast</code> to them, <code>query</code> and <code>update!</code> them. Please follow along in your Julia REPL and don&#39;t hesitate to try things out.</p><h2 id="spawn"><a class="docs-heading-anchor" href="#spawn"><code>spawn</code></a><a id="spawn-1"></a><a class="docs-heading-anchor-permalink" href="#spawn" title="Permalink"></a></h2><p>The basic mechanism to create new actors is the <a href="../api/#ActorInterfaces.Classic.spawn"><code>spawn</code></a> function. You have to import it explicitly:</p><pre><code class="language-julia-repl">julia&gt; using Actors

julia&gt; import Actors: spawn, newLink</code></pre><p>You then can <code>spawn</code> actors with any callable Julia object. This is called a <a href="../behaviors/">behavior</a> function.</p><pre><code class="language-julia-repl">julia&gt; myactor = spawn(Threads.threadid)
Link{Channel{Any}}(Channel{Any}(sz_max:32,sz_curr:0), 1, :default)</code></pre><p><code>spawn</code> returned an actor <a href="../api/#Actors.Link"><code>Link</code></a>. This is the actor&#39;s mail address and its only representation. You can use it to send messages to it or to call it. If you call it, it executes its behavior and responds with the result:</p><pre><code class="language-julia-repl">julia&gt; call(myactor)
1</code></pre><p>Now currently our actor does only that: it responds its thread id until you send it a message which it cannot understand or you stop it.</p><pre><code class="language-julia-repl">julia&gt; send(myactor, &quot;Boom&quot;)
(&quot;Boom&quot;,)

julia&gt; Actors.info(myactor)
Task (failed) @0x00007f172c6dc4f0
MethodError: no method matching threadid(::String)
Closest candidates are:
  threadid(!Matched::Task) at task.jl:187
  threadid() at threadingconstructs.jl:10
(::Actors.var&quot;#4#6&quot;{Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}},typeof(Base.Threads.threadid),Tuple{}})(::Tuple{String}) at /home/runner/work/Actors.jl/Actors.jl/src/types.jl:40
(::Bhv)(::String) at /home/runner/work/Actors.jl/Actors.jl/src/types.jl:42
#invokelatest#1 at ./essentials.jl:710 [inlined]
invokelatest at ./essentials.jl:709 [inlined]
onmessage at /home/runner/work/Actors.jl/Actors.jl/src/actor.jl:39 [inlined]
onmessage(::Actors._ACT, ::Val{:default}, ::Tuple{String}) at /home/runner/work/Actors.jl/Actors.jl/src/actor.jl:53
_act(::Channel{Any}) at /home/runner/work/Actors.jl/Actors.jl/src/actor.jl:66
(::Actors.var&quot;#32#36&quot;)() at /home/runner/work/Actors.jl/Actors.jl/src/actor.jl:105</code></pre><p>We caused our actor to fail. Ouch!</p><h2 id="become"><a class="docs-heading-anchor" href="#become"><code>become</code></a><a id="become-1"></a><a class="docs-heading-anchor-permalink" href="#become" title="Permalink"></a></h2><p>Now we want our actor to do something more meaningful. Let&#39;s write our own behavior function. We want a calculator actor sending the result of an arithmetic operation back to a given address:</p><pre><code class="language-julia-repl">julia&gt; function calc(addr::Link, f::Function, args...)
           send(addr, f(args...))
       end
calc (generic function with 1 method)</code></pre><p>Now we create a link for ourselves and start a new actor with a <code>calc</code> behavior and that link as <em>acquaintance</em> parameter.</p><pre><code class="language-julia-repl">julia&gt; me = newLink()
Link{Channel{Any}}(Channel{Any}(sz_max:32,sz_curr:0), 1, :local)

julia&gt; myactor = spawn(calc, me)
Link{Channel{Any}}(Channel{Any}(sz_max:32,sz_curr:0), 1, :default)</code></pre><p>We applied our <code>calc</code> function partially to <code>me</code>. Now our actor holds the <code>me</code> link as acquaintance and we need to <code>send</code> it only the rest of the parameters to cause it to do execute <code>f</code> on some parameters and to send the result back to <code>me</code>:</p><pre><code class="language-julia-repl">julia&gt; send(myactor, +, 1, 2, 3, 4)
(+, 1, 2, 3, 4)

julia&gt; receive(me)
10</code></pre><p>If we want our actor to do only multiplication, we can change its behavior with <a href="../api/#Actors.become!"><code>become!</code></a> to <code>calc</code> with new acquaintances:</p><pre><code class="language-julia-repl">julia&gt; become!(myactor, calc, me, *);</code></pre><p>Now it does multiplication only and we can <code>send</code> it the communication parameters and <code>receive</code> the result:</p><pre><code class="language-julia-repl">julia&gt; send(myactor, 1,2,3,4)
(1, 2, 3, 4)

julia&gt; receive(me)
24</code></pre><p>An actor can change also its own behavior with <a href="../api/#ActorInterfaces.Classic.become"><code>become</code></a>. Since an actor does what its behavior tells it to do, you use <code>become</code> inside a behavior function to cause the actor to switch to a new behavior. Instead <code>become!</code> is a call from the outside of an actor. A behavior change is effective for the next message an actor receives.</p><h2 id="send-and-receive"><a class="docs-heading-anchor" href="#send-and-receive"><code>send</code> and <code>receive</code></a><a id="send-and-receive-1"></a><a class="docs-heading-anchor-permalink" href="#send-and-receive" title="Permalink"></a></h2><p>When we used <a href="../api/#ActorInterfaces.Classic.send"><code>send</code></a> and <a href="../api/#Actors.receive"><code>receive</code></a> in our experiments so far, we did <em>asynchronous communication</em> with our actor. After sending something to it we could have done other work and receive the result later.</p><p>But what happens if we try to <code>receive</code> something from a failed actor?</p><pre><code class="language-julia-repl">julia&gt; send(myactor, 5, &quot;x&quot;)
(5, &quot;x&quot;)

julia&gt; receive(me)
Actors.Timeout()</code></pre><p>After some seconds we got a <code>Timeout()</code>.</p><h2 id="request"><a class="docs-heading-anchor" href="#request"><code>request</code></a><a id="request-1"></a><a class="docs-heading-anchor-permalink" href="#request" title="Permalink"></a></h2><p>We don&#39;t give up with it and start it again, but now we want our actor to be an adding machine with an offset of 1000:</p><pre><code class="language-julia-repl">julia&gt; myactor = spawn(+, 1000)
Link{Channel{Any}}(Channel{Any}(sz_max:32,sz_curr:0), 1, :default)</code></pre><p>Now our actor has no acquaintance of <code>me</code> neither has its behavior any send instruction. If we <code>send</code> it something, it will only add to 1000 but not respond anything.</p><p>Now we can use <a href="../api/#Actors.request"><code>request</code></a>. This will create a link internally and <code>send</code> it and the communication parameters with a <a href="../api/#Actors.Request"><code>Request</code></a> to the actor. Then it knows that it must send a <a href="../api/#Actors.Response"><code>Response</code></a> to the received link. <code>request</code> can then deliver the response:</p><pre><code class="language-julia-repl">julia&gt; request(myactor, 1,2,3)
1006</code></pre><p>This is <em>synchronous communication</em>. <code>request</code> blocks until it <code>receive</code>s the result (or a <code>Timeout()</code>).</p><h2 id="call,-cast,-query,-update!-..."><a class="docs-heading-anchor" href="#call,-cast,-query,-update!-..."><code>call</code>, <code>cast</code>, <code>query</code>, <code>update!</code> ...</a><a id="call,-cast,-query,-update!-...-1"></a><a class="docs-heading-anchor-permalink" href="#call,-cast,-query,-update!-..." title="Permalink"></a></h2><p>Can we still do asynchronous communication with this actor? Yes we can, if we use <a href="../api/#Actors.call"><code>call</code></a> with the <code>me</code> link. This sends the given link to the actor and it responds to it. Then we can <code>receive</code> the result asynchronously:</p><pre><code class="language-julia-repl">julia&gt; call(myactor, me, 1000)
Actors.Call((1000,), Link{Channel{Any}}(Channel{Any}(sz_max:32,sz_curr:1), 1, :local))

julia&gt; receive(me).y
2000</code></pre><p>If we don&#39;t provide a return link to <code>call</code>, it will use <code>request</code> and deliver the result synchronously:</p><pre><code class="language-julia-repl">julia&gt; call(myactor, 2000)
3000</code></pre><pre><code class="language-julia-repl"></code></pre><pre><code class="language-julia-repl"></code></pre><pre><code class="language-julia-repl"></code></pre><pre><code class="language-julia-repl"></code></pre><pre><code class="language-julia-repl"></code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Actors Documentation</a><a class="docs-footer-nextpage" href="../basics/">Basics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 11 December 2020 15:44">Friday 11 December 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
